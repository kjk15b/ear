{
   "paths": [
      [
         "C:\\Windows\\System32\\WindowsPowerShell\\v1.0",
         "99.52"
      ],
      [
         "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0",
         "0.48"
      ],
      [
         "C:\\Windows\\syswow64\\WindowsPowerShell\\v1.0",
         "0.00"
      ]
   ],
   "parents": [
      [
         "cmd.exe",
         "81.79"
      ],
      [
         "jumpcloud-agent.exe",
         "16.41"
      ],
      [
         "svchost.exe",
         "0.90"
      ],
      [
         "LTSVC.exe",
         "0.27"
      ],
      [
         "KInventory.exe",
         "0.18"
      ],
      [
         "CompatTelRunner.exe",
         "0.13"
      ],
      [
         "konea.exe",
         "0.10"
      ],
      [
         "amagent.exe",
         "0.08"
      ],
      [
         "gpscript.exe",
         "0.04"
      ],
      [
         "taskeng.exe",
         "0.04"
      ],
      [
         "Dropbox.exe",
         "0.01"
      ],
      [
         "WmiPrvSE.exe",
         "0.01"
      ],
      [
         "explorer.exe",
         "0.01"
      ],
      [
         "powershell.exe",
         "0.01"
      ],
      [
         "RadeonSoftware.exe",
         "0.01"
      ],
      [
         "Lenovo.Modern.ImController.exe",
         "0.00"
      ],
      [
         "V8DerechoSetup_58E5B9A2.tmp",
         "0.00"
      ],
      [
         "msiexec.exe",
         "0.00"
      ],
      [
         "jumpcloud-agent-updater.exe",
         "0.00"
      ],
      [
         "jumpcloud-agent-app.exe",
         "0.00"
      ],
      [
         "RingCentral.exe",
         "0.00"
      ]
   ],
   "children": [
      [
         "conhost.exe",
         "64.42"
      ],
      [
         "wmic.exe",
         "15.87"
      ],
      [
         "jcosqueryi.exe",
         "10.27"
      ],
      [
         "findstr.exe",
         "2.60"
      ],
      [
         "gpupdate.exe",
         "2.35"
      ],
      [
         "DismHost.exe",
         "1.57"
      ],
      [
         "tracerpt.exe",
         "0.87"
      ],
      [
         "reg.exe",
         "0.38"
      ],
      [
         "KPlugins.exe",
         "0.35"
      ],
      [
         "secedit.exe",
         "0.32"
      ],
      [
         "dismhost.exe",
         "0.25"
      ],
      [
         "takeown.exe",
         "0.14"
      ],
      [
         "csc.exe",
         "0.11"
      ],
      [
         "WMIC.exe",
         "0.08"
      ],
      [
         "HOSTNAME.EXE",
         "0.07"
      ],
      [
         "WerFault.exe",
         "0.06"
      ],
      [
         "expand.exe",
         "0.05"
      ],
      [
         "hostname.exe",
         "0.04"
      ],
      [
         "PING.EXE",
         "0.02"
      ],
      [
         "powershell.exe",
         "0.02"
      ],
      [
         "taskkill.exe",
         "0.01"
      ]
   ],
   "grandparents": [
      [
         "LTSVC.exe",
         "97.77"
      ],
      [
         "services.exe",
         "1.47"
      ],
      [
         "runkbot.exe",
         "0.29"
      ],
      [
         "svchost.exe",
         "0.18"
      ],
      [
         "32bitProxy.exe",
         "0.17"
      ],
      [
         "Asusgiftbox.exe",
         "0.05"
      ],
      [
         "userinit.exe",
         "0.01"
      ],
      [
         "explorer.exe",
         "0.01"
      ],
      [
         "EchoTrailSetup.exe",
         "0.00"
      ],
      [
         "msiexec.exe",
         "0.00"
      ],
      [
         "Lenovo.Modern.ImController.exe",
         "0.00"
      ],
      [
         "cmd.exe",
         "0.00"
      ],
      [
         "dsAccessService.exe",
         "0.00"
      ],
      [
         "V8DerechoSetup_58E5B9A2.exe",
         "0.00"
      ],
      [
         "V8DerechoSetup.exe",
         "0.00"
      ],
      [
         "DropboxClient_48.4.58.exe",
         "0.00"
      ],
      [
         "windeploy.exe",
         "0.00"
      ],
      [
         "DropboxClient_47.4.74.exe",
         "0.00"
      ],
      [
         "DropboxClient_46.4.65.exe",
         "0.00"
      ],
      [
         "DropboxClient_44.4.58.exe",
         "0.00"
      ],
      [
         "PDQDeployRunner-1.exe",
         "0.00"
      ]
   ],
   "hashes": [
      [
         "34507738f84b9d4f231dc0c187fee4a03b4ddb84cf63ff56a4a1761a9bd56ea6",
         "41.50"
      ],
      [
         "9f914d42706fe215501044acd85a32d58aaef1419d404fddfa5d3b48f66ccd9f",
         "29.15"
      ],
      [
         "840e1f9dc5a29bebf01626822d7390251e9cf05bb3560ba7b68bdb8a41cf08e3",
         "15.66"
      ],
      [
         "ccc8538dd62f20999717e2bbab58a18973b938968d699154df9233698a899efa",
         "6.09"
      ],
      [
         "ba4038fd20e474c047be8aad5bfacdb1bfc1ddbe12f803f473b7918d8d819436",
         "2.86"
      ],
      [
         "d3f8fade829d2b7bd596c4504a6dae5c034e789b6a3defbe013bda7d14466677",
         "2.41"
      ],
      [
         "a8fdba9df15e41b6f5c69c79f66a26a9d48e174f9e7018a371600b866867dab8",
         "1.61"
      ],
      [
         "67715009a6373acc7c2bb491d93c3eddd3d0f989c4c2fb60618e056898e60e49",
         "0.26"
      ],
      [
         "65554b6cabe23a726eadcb72b09204e63afc6a76277c997528ca28ea084c4b3d",
         "0.09"
      ],
      [
         "908b64b1971a979c7e3e8ce4621945cba84854cb98d76367b791a6e22b5f6d53",
         "0.09"
      ],
      [
         "d2434e607451a4d29d28f43a529246dc81d25a2fae9c271e28c55452c09a28a5",
         "0.08"
      ],
      [
         "73a3c4aef5de385875339fc2eb7e58a9e8a47b6161bdc6436bf78a763537be70",
         "0.06"
      ],
      [
         "e0c662d10b852b23f2d8a240afc82a72b099519fa71cddf9d5d0f0be08169b6e",
         "0.05"
      ],
      [
         "c7d4e119149a7150b7101a4bd9fffbf659fba76d058f7bf6cc73c99fb36e8221",
         "0.04"
      ],
      [
         "7762a4766bc394b4cb2d658144b207183ff23b3139181cd74e615db63e6e57d6",
         "0.02"
      ],
      [
         "9af8a2d9ca5d904b9ca6696016b2a794ef7eb97693ccca22df2a367305d31b88",
         "0.01"
      ],
      [
         "0bbf1952ee724d29f04d9ea52cae9c8c781791d57ed127ae7b618704c3395a79",
         "0.00"
      ],
      [
         "de96a6e69944335375dc1ac238336066889d9ffc7d73628ef4fe1b1b160ab32c",
         "0.00"
      ],
      [
         "8787d4b624880012abdb442532be762db0361dece169fef9e1e877a9df9e00cb",
         "0.00"
      ],
      [
         "8133502266008b77de7921451e1210b0ef3f0ed2db7d8d3ee0c3350d856fa6fa",
         "0.00"
      ],
      [
         "e9fa973eb5ad446e0be31c7b8ae02d48281319e7f492e1ddaadddfbdd5b480c7",
         "0.00"
      ]
   ],
   "network": [
      [
         "80",
         "50.63"
      ],
      [
         "8080",
         "31.59"
      ],
      [
         "135",
         "4.32"
      ],
      [
         "5985",
         "3.69"
      ],
      [
         "443",
         "2.92"
      ],
      [
         "389",
         "1.57"
      ],
      [
         "53",
         "0.63"
      ],
      [
         "8443",
         "0.26"
      ],
      [
         "49156",
         "0.21"
      ],
      [
         "49157",
         "0.11"
      ],
      [
         "49155",
         "0.10"
      ],
      [
         "49158",
         "0.08"
      ],
      [
         "49671",
         "0.08"
      ],
      [
         "9389",
         "0.06"
      ],
      [
         "49670",
         "0.06"
      ],
      [
         "49672",
         "0.05"
      ],
      [
         "47001",
         "0.05"
      ],
      [
         "25",
         "0.05"
      ],
      [
         "49669",
         "0.04"
      ],
      [
         "49159",
         "0.04"
      ],
      [
         "49160",
         "0.03"
      ]
   ],
   "rank": 6,
   "host_prev": "88.8",
   "eps": "92.16",
   "description": "Powershell is a Windows native command line interpreter. It is very commonly executed across most environments and a popular tool for both administrators as well as attackers.",
   "intel": "Powershell.exe is one of the most commonly used utilities built into Windows. Its uses are too numerous to capture here. With powershell behavior it can be difficult to distinguish between admin and attacker behavior. Attackers often use this tool because it is so powerful, but also because it is so common. Some of the indicators of attacker use are command line switches like \u2013enc or HiddenWindow. While these are also used in legitimate cases, they are of typically of sufficient interest to look deeper at the surrounding context of powershell's use.\n\nPowershell Obfuscation:\nhttps://www.trustedsec.com/blog/circumventing-encodedcommand-detection-powershell/\ne.g: \n\npowershell -window hidden -C \"set-variable -name \"LB\" -value \"-\"; set-variable -name \"I\" -value \"e\"; set-variable -name \"V\" -value \"c\"; set-variable -name \"wP\" -value ((get-variable LB).value.toString()+(get-variable I).value.toString()+(get-variable V).value.toString()) ; powershell (get-variable wP).value.toString() <base64_string>\n\nPowershell Execution Policy Bypass Techniques\nhttps://blog.netspi.com/15-ways-to-bypass-the-powershell-execution-policy/\n\nPowershell alternatives to the traditional host info e.g. whoami:\nhttp://www.blackhillsinfosec.com/?p=5824 \n\nBase64 Decode\nTo decode a base64 string on Mac:\necho [base64string without brackets] | base64 \u2013D\n \nTo decode a base64 string on Windows:\necho [base64string without brackets] > encoded.txt\ncertutil -decode encoded.txt decoded.txt\ntype decoded.txt\n \nDecode base64 in Powershell:\nPS > [System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String(\"encoded stuff goes here \"))\n"
}